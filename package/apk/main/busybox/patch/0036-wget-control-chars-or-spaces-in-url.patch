https://lists.busybox.net/pipermail/busybox/2025-November/091818.html

From radoslav.kolev@suse.com Wed Nov 12 17:50:54 2025
From: Radoslav Kolev <radoslav.kolev@suse.com>
Date: Wed, 12 Nov 2025 19:50:54 +0200
Subject: [PATCH 1/1] wget: don't allow control characters or spaces in the URL
To: busybox@busybox.net
Message-ID: <20251112175055.2193014-2-radoslav.kolev@suse.com>
References: <20251112175055.2193014-1-radoslav.kolev@suse.com>
In-Reply-To: <20251112175055.2193014-1-radoslav.kolev@suse.com>
Mime-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Length: 872
Lines: 30

Fixes CVE-2025-60876 malicious URL can be used to inject
HTTP headers in the request.

Signed-off-by: Radoslav Kolev <radoslav.kolev@suse.com>
---
 networking/wget.c | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/networking/wget.c b/networking/wget.c
index ec3767793..b8a6d02bb 100644
--- a/networking/wget.c
+++ b/networking/wget.c
@@ -536,6 +536,15 @@ static void parse_url(const char *src_url, struct host_info *h)
 {
 	char *url, *p, *sp;
 
+	/* Fix for CVE-2025-60876 - don't allow control characters or spaces in the URL */
+	/* otherwise a malicious URL can be used to inject HTTP headers in the request */
+	unsigned char *u = (void *) src_url;
+	while (*u) {
+		if (*u <= ' ')
+			bb_simple_error_msg_and_die("Unencoded control character found in the URL!");
+		u++;
+	}
+
 	free(h->allocated);
 	h->allocated = url = xstrdup(src_url);
 
-- 
2.51.1
